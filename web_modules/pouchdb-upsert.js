import{a as f,c as _}from"./common/_commonjsHelpers-267afc3a.js";var b=f.MutationObserver||f.WebKitMutationObserver,m;if(b){var D=0,M=new b(g),F=f.document.createTextNode("");M.observe(F,{characterData:!0}),m=function(){F.data=D=++D%2}}else if(!f.setImmediate&&typeof f.MessageChannel!="undefined"){var R=new f.MessageChannel();R.port1.onmessage=g,m=function(){R.port2.postMessage(0)}}else"document"in f&&"onreadystatechange"in f.document.createElement("script")?m=function(){var e=f.document.createElement("script");e.onreadystatechange=function(){g(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},f.document.documentElement.appendChild(e)}:m=function(){setTimeout(g,0)};var E,y=[];function g(){E=!0;for(var e,r,t=y.length;t;){for(r=y,y=[],e=-1;++e<t;)r[e]();t=y.length}E=!1}var L=A;function A(e){y.push(e)===1&&!E&&m()}function p(){}var a={},q=["REJECTED"],T=["FULFILLED"],N=["PENDING"],k=h;function h(e){if(typeof e!="function")throw new TypeError("resolver must be a function");this.state=N,this.queue=[],this.outcome=void 0,e!==p&&P(this,e)}h.prototype.catch=function(e){return this.then(null,e)},h.prototype.then=function(e,r){if(typeof e!="function"&&this.state===T||typeof r!="function"&&this.state===q)return this;var t=new this.constructor(p);if(this.state!==N){var i=this.state===T?e:r;C(t,i,this.outcome)}else this.queue.push(new w(t,e,r));return t};function w(e,r,t){this.promise=e,typeof r=="function"&&(this.onFulfilled=r,this.callFulfilled=this.otherCallFulfilled),typeof t=="function"&&(this.onRejected=t,this.callRejected=this.otherCallRejected)}w.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},w.prototype.otherCallFulfilled=function(e){C(this.promise,this.onFulfilled,e)},w.prototype.callRejected=function(e){a.reject(this.promise,e)},w.prototype.otherCallRejected=function(e){C(this.promise,this.onRejected,e)};function C(e,r,t){L(function(){var i;try{i=r(t)}catch(u){return a.reject(e,u)}i===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,i)})}a.resolve=function(e,r){var t=x(I,r);if(t.status==="error")return a.reject(e,t.value);var i=t.value;if(i)P(e,i);else{e.state=T,e.outcome=r;for(var u=-1,o=e.queue.length;++u<o;)e.queue[u].callFulfilled(r)}return e},a.reject=function(e,r){e.state=q,e.outcome=r;for(var t=-1,i=e.queue.length;++t<i;)e.queue[t].callRejected(r);return e};function I(e){var r=e&&e.then;if(e&&(typeof e=="object"||typeof e=="function")&&typeof r=="function")return function(){r.apply(e,arguments)}}function P(e,r){var t=!1;function i(n){if(t)return;t=!0,a.reject(e,n)}function u(n){if(t)return;t=!0,a.resolve(e,n)}function o(){r(u,i)}var s=x(o);s.status==="error"&&i(s.value)}function x(e,r){var t={};try{t.value=e(r),t.status="success"}catch(i){t.status="error",t.value=i}return t}h.resolve=O;function O(e){return e instanceof this?e:a.resolve(new this(p),e)}h.reject=U;function U(e){var r=new this(p);return a.reject(r,e)}h.all=G;function G(e){var r=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var t=e.length,i=!1;if(!t)return this.resolve([]);for(var u=new Array(t),o=0,s=-1,n=new this(p);++s<t;)c(e[s],s);return n;function c(l,v){r.resolve(l).then(d,function(j){i||(i=!0,a.reject(n,j))});function d(j){u[v]=j,++o===t&&!i&&(i=!0,a.resolve(n,u))}}}h.race=S;function S(e){var r=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var t=e.length,i=!1;if(!t)return this.resolve([]);for(var u=-1,o=new this(p);++u<t;)s(e[u]);return o;function s(n){r.resolve(n).then(function(c){i||(i=!0,a.resolve(o,c))},function(c){i||(i=!0,a.reject(o,c))})}}var B=typeof Promise=="function"?Promise:k,J=_(function(e,r){function t(u,o,s){return typeof o!="string"?B.reject(new Error("doc id is required")):u.get(o).catch(function(n){if(n.status!==404)throw n;return{}}).then(function(n){var c=n._rev,l=s(n);return l?(l._id=o,l._rev=c,i(u,l,s)):{updated:!1,rev:c,id:o}})}function i(u,o,s){return u.put(o).then(function(n){return{updated:!0,rev:n.rev,id:o._id}},function(n){if(n.status!==409)throw n;return t(u,o._id,s)})}r.upsert=function(o,s,n){var c=this,l=t(c,o,s);if(typeof n!="function")return l;l.then(function(v){n(null,v)},n)},r.putIfNotExists=function(o,s,n){var c=this;typeof o!="string"&&(n=s,s=o,o=s._id);var l=function(d){return d._rev?!1:s},v=t(c,o,l);if(typeof n!="function")return v;v.then(function(d){n(null,d)},n)},typeof window!="undefined"&&window.PouchDB&&window.PouchDB.plugin(r)});export default J;
